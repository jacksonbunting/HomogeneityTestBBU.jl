var documenterSearchIndex = {"docs":
[{"location":"#HomogeneityTestBBU.jl","page":"Home","title":"HomogeneityTestBBU.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"HomogeneityTestBBU implements the permutation test from Bugni, Bunting and Ura (2023). By default, the test function takes the data X and a test statistic test_stat_fn and returns the p-value computed as Equation (4), Bugni, Bunting and Ura (2023). The test rejects the null of homogeneity for all significance levels greater than the p-value.","category":"page"},{"location":"","page":"Home","title":"Home","text":"homogeneity_test_fn","category":"page"},{"location":"#HomogeneityTestBBU.homogeneity_test_fn","page":"Home","title":"HomogeneityTestBBU.homogeneity_test_fn","text":"homogeneity_test_fn\n\nThis function implements the homogeneity test of Bugni, Bunting and Ura (2023).\n\nArguments\n\nX::Tuple: The data in the form of tuple X=(S A), where A may be empty.\ntest_stat_fn::Function: A function that takes the arguments S and A (or S only, if A=) and returns a (vector of) test statistics.\nK::Int: An integer indicating the length of the MCMC chain. Defaults to 10,000.\nverbose::Vector{String}: Possible elements of the vector are \"P value\", \"Test stat\", and \"X^K\". Defaults to empty.\nA_trivial::Boolean: A Boolean indicating whether S=A. Defaults to false.\n\nValues\n\nPvalue: The test's p-value (Bugni, Bunting and Ura (2023), equation (4)).\nPvalue_chain: The p-value computed at each of K steps (optional).\ntest_stat_chain: The test statistic computed on X and of K steps (optional).\n`X_K': The tuple containing the the permuted data (optional).\n\n\n\n\n\n","category":"function"},{"location":"","page":"Home","title":"Home","text":"euler_algorithm","category":"page"},{"location":"#HomogeneityTestBBU.euler_algorithm","page":"Home","title":"HomogeneityTestBBU.euler_algorithm","text":"euler_algorithm\n\nThis function applies a Euler algorithm to the First Order Markov chain x\n\nArguments\n\nx::vector\n\n\n\n\n\n","category":"function"},{"location":"#Empirical-vignette","page":"Home","title":"Empirical vignette","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The following code replicates the empirical application in Bugni, Bunting and Ura (2023).","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Random, HomogeneityTestBBU\r\nS = [ 13  13  13  13  11   8   8   8   7   7   6   6   9   9   9   8   8   9   9;\r\n 15  20  19  19  20  20  14  15  21  20  20  20  21  21  19  19  19  20  20;\r\n 14  14  14  14  14  15  15  15  15  15  15  15  13  13  12  12  12  12  12;\r\n 12  12  12  12  12  12  12  12  12  12  13  13  13  13  13  13  12  13  13;\r\n 32  36  36  37  38  38  38  36  32  33  33  35  36  35  33  33  33  35  34;\r\n 13  18  16  16  16  17  17  17  14  15  15  14  14  15  13  13  13  13  13;\r\n  7  10  10  10  10   8   8   9  11  11  11  10  10  10   9  10  10  10  10;\r\n 17  17  18  18  18  18  18  16  16  16  16  15  15  15  14  14  14  14  14;\r\n 14  13  13  11  11  11  11  12  12  12  12  11  11  11  10  11  11  11  10;\r\n 23  23  22  24  24  24  24  24  23  22  22  20  20  20  19  20  20  20  20;\r\n  8  10  10  10  10  10  10  10  10   8   8   8   8   8   8   8   9   9  10;\r\n 13  13  13  12  12   7   7   9  12  12  12  13  13  13  12  12  12  12  12;\r\n 14  14  14  14  14  14  14  14  14  14  14  14  14  14  13  12  12  13  13;\r\n 11  11  11  11  11  11  11  11  11  11   9   9   9   9   8   8   8   8   8;\r\n 11  11  11   9   9   9   8   9   9   6   6   6   6   6   5   6   6   6   6;\r\n 17  18  18  18  18  17  18  18  18  18  18  18  18  18  16  16  16  16  17;\r\n 28  25  23  25  25  23  23  23  23  23  23  23  24  24  22  22  22  20  20;\r\n 22  21  21  22  21  21  22  22  22  21  22  21  21  22  20  20  20  20  21;\r\n 19  19  15  17  17  17  17  17  17  17  17  17  18  18  14  14  14  14  15;\r\n 11  12  12  12  11  11  11   9   8   8   8   8   8   5   5   5   5   5   5;\r\n 33  32  27  30  30  30  30  31  31  31  31  33  33  34  30  31  30  31  31;\r\n 12  12  12  11  12  12  12  12  12  12  12  13  12  12  11  11  11  11  12;\r\n 47  46  45  51  48  47  47  44  43  39  39  39  39  39  36  36  36  36  36]\r\n\r\nfunction test_fn(S_data)\r\n    S_support = sort(unique(S_data[:,1:(end-1)]))\r\n    outcome_support = sort(unique(S_data[:,2:end]))\r\n    \r\n    S_cols = size(S_data, 2);\r\n\r\n    T_P = 0;\r\n    T_P_star = 0;\r\n    \r\n    for j2 in eachindex(S_support)\r\n        tmp0 = S_data[:,1:(end-1)] .== S_support[j2];\r\n        tmp1 = unique(S_data[:,2:end][tmp0])\r\n        tmp_i = findall(vec(sum(tmp0, dims=2) .> 0))\r\n        for j3 in eachindex(tmp1)\r\n            P_d_tmp = sum((S_data[:,2:end][tmp0] .== tmp1[j3])) / sum(tmp0);\r\n            for j1 in tmp_i\r\n                P_j_d_tmp = sum((S_data[j1,2:end][tmp0[j1,:]] .== tmp1[j3])) / sum(tmp0[j1,:]);\r\n                W_j_d_tmp = sum(tmp0[j1,:]) / P_d_tmp\r\n                T_P = T_P + W_j_d_tmp * (P_j_d_tmp - P_d_tmp)^2\r\n                if P_j_d_tmp > 0\r\n                    T_P_star = T_P_star + 2 *  W_j_d_tmp * P_d_tmp * P_j_d_tmp * log(P_j_d_tmp / P_d_tmp)\r\n                end\r\n            end\r\n        end\r\n    end\r\n    return T_P, T_P_star\r\nend\r\n\r\nhomogeneity_test_fn(X = (S[:,12:end], []),\r\n    test_stat_fn = test_fn,\r\n    K=3)\r\nRandom.seed!(1234)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Before = S[:,1:11];\r\nAfter = S[:,12:end];\r\n\r\n@time tAfter = homogeneity_test_fn(X = (After, []),\r\n    test_stat_fn = test_fn,\r\n    K=50000)\r\nprintln(tAfter.Pvalue)\r\n\r\n@time tBefore = homogeneity_test_fn(X = (Before, []),\r\n    test_stat_fn = test_fn,\r\n    K=50000)\r\nprintln(tBefore.Pvalue)","category":"page"},{"location":"#Data-and-test-statistic-for-empirical-vignette","page":"Home","title":"Data and test statistic for empirical vignette","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"S = [ 13  13  13  13  11   8   8   8   7   7   6   6   9   9   9   8   8   9   9;\r\n 15  20  19  19  20  20  14  15  21  20  20  20  21  21  19  19  19  20  20;\r\n 14  14  14  14  14  15  15  15  15  15  15  15  13  13  12  12  12  12  12;\r\n 12  12  12  12  12  12  12  12  12  12  13  13  13  13  13  13  12  13  13;\r\n 32  36  36  37  38  38  38  36  32  33  33  35  36  35  33  33  33  35  34;\r\n 13  18  16  16  16  17  17  17  14  15  15  14  14  15  13  13  13  13  13;\r\n  7  10  10  10  10   8   8   9  11  11  11  10  10  10   9  10  10  10  10;\r\n 17  17  18  18  18  18  18  16  16  16  16  15  15  15  14  14  14  14  14;\r\n 14  13  13  11  11  11  11  12  12  12  12  11  11  11  10  11  11  11  10;\r\n 23  23  22  24  24  24  24  24  23  22  22  20  20  20  19  20  20  20  20;\r\n  8  10  10  10  10  10  10  10  10   8   8   8   8   8   8   8   9   9  10;\r\n 13  13  13  12  12   7   7   9  12  12  12  13  13  13  12  12  12  12  12;\r\n 14  14  14  14  14  14  14  14  14  14  14  14  14  14  13  12  12  13  13;\r\n 11  11  11  11  11  11  11  11  11  11   9   9   9   9   8   8   8   8   8;\r\n 11  11  11   9   9   9   8   9   9   6   6   6   6   6   5   6   6   6   6;\r\n 17  18  18  18  18  17  18  18  18  18  18  18  18  18  16  16  16  16  17;\r\n 28  25  23  25  25  23  23  23  23  23  23  23  24  24  22  22  22  20  20;\r\n 22  21  21  22  21  21  22  22  22  21  22  21  21  22  20  20  20  20  21;\r\n 19  19  15  17  17  17  17  17  17  17  17  17  18  18  14  14  14  14  15;\r\n 11  12  12  12  11  11  11   9   8   8   8   8   8   5   5   5   5   5   5;\r\n 33  32  27  30  30  30  30  31  31  31  31  33  33  34  30  31  30  31  31;\r\n 12  12  12  11  12  12  12  12  12  12  12  13  12  12  11  11  11  11  12;\r\n 47  46  45  51  48  47  47  44  43  39  39  39  39  39  36  36  36  36  36];\r\n\r\nfunction test_fn(S_data)\r\n    S_support = sort(unique(S_data[:,1:(end-1)]))\r\n    outcome_support = sort(unique(S_data[:,2:end]))\r\n    \r\n    S_cols = size(S_data, 2);\r\n\r\n    T_P = 0;\r\n    T_P_star = 0;\r\n    \r\n    for j2 in eachindex(S_support)\r\n        tmp0 = S_data[:,1:(end-1)] .== S_support[j2];\r\n        tmp1 = unique(S_data[:,2:end][tmp0])\r\n        tmp_i = findall(vec(sum(tmp0, dims=2) .> 0))\r\n        for j3 in eachindex(tmp1)\r\n            P_d_tmp = sum((S_data[:,2:end][tmp0] .== tmp1[j3])) / sum(tmp0);\r\n            for j1 in tmp_i\r\n                P_j_d_tmp = sum((S_data[j1,2:end][tmp0[j1,:]] .== tmp1[j3])) / sum(tmp0[j1,:]);\r\n                W_j_d_tmp = sum(tmp0[j1,:]) / P_d_tmp\r\n                T_P = T_P + W_j_d_tmp * (P_j_d_tmp - P_d_tmp)^2\r\n                if P_j_d_tmp > 0\r\n                    T_P_star = T_P_star + 2 *  W_j_d_tmp * P_d_tmp * P_j_d_tmp * log(P_j_d_tmp / P_d_tmp)\r\n                end\r\n            end\r\n        end\r\n    end\r\n    return T_P, T_P_star\r\nend","category":"page"}]
}
